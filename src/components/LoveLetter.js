import React, { useState, useEffect } from "react";
import { Dialog, Box, Typography, IconButton } from "@mui/material";
import CloseIcon from "@mui/icons-material/Close";

const loveMessage = `
à¸–à¸¶à¸‡à¸„à¸™à¸—à¸µà¹ˆà¹€à¸„à¹‰à¸²à¸£à¸±à¸à¸—à¸µà¹ˆà¸ªà¸¸à¸”à¹ƒà¸™à¹‚à¸¥à¸,

à¸•à¸±à¹‰à¸‡à¹à¸•à¹ˆà¸§à¸±à¸™à¹à¸£à¸à¸—à¸µà¹ˆà¹€à¸£à¸²à¹„à¸”à¹‰à¸à¸šà¸à¸±à¸™ à¸«à¸±à¸§à¹ƒà¸ˆà¸‚à¸­à¸‡à¹€à¸„à¹‰à¸²à¸à¹‡à¸–à¸¹à¸à¹€à¸•à¸´à¸¡à¹€à¸•à¹‡à¸¡à¹„à¸›à¸”à¹‰à¸§à¸¢à¸„à¸§à¸²à¸¡à¸£à¸±à¸à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸ªà¸¸à¸‚
à¸—à¸¸à¸à¸Šà¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸²à¸—à¸µà¹ˆà¹€à¸£à¸²à¹ƒà¸Šà¹‰à¸”à¹‰à¸§à¸¢à¸à¸±à¸™à¹€à¸›à¹‡à¸™à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸¡à¸µà¸„à¹ˆà¸²à¸—à¸µà¹ˆà¸ªà¸¸à¸”à¹ƒà¸™à¸Šà¸µà¸§à¸´à¸•à¸‚à¸­à¸‡à¹€à¸„à¹‰à¸²à¹€à¸¥à¹‰à¸¢

à¹€à¸„à¹‰à¸²à¸­à¸²à¸ˆà¸ˆà¸°à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸à¸¹à¸”à¸„à¸³à¸§à¹ˆà¸² "à¸£à¸±à¸" à¸šà¹ˆà¸­à¸¢à¹† 
à¹à¸•à¹ˆà¹€à¸„à¹‰à¸²à¸­à¸¢à¸²à¸à¹ƒà¸«à¹‰à¹€à¸šà¹Šà¸šà¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸¡à¸±à¸™à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸—à¸¸à¸à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¹€à¸„à¹‰à¸²à¸—à¸³à¹ƒà¸«à¹‰à¹€à¸šà¹Šà¸š à¸—à¸¸à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸—à¸µà¹ˆà¹€à¸„à¹‰à¸²à¸ªà¹ˆà¸‡à¹ƒà¸«à¹‰ 
à¸—à¸¸à¸à¸„à¸£à¸±à¹‰à¸‡à¸—à¸µà¹ˆà¹€à¸„à¹‰à¸²à¹€à¸›à¹‡à¸™à¸«à¹ˆà¸§à¸‡ à¸—à¸¸à¸à¸„à¸£à¸±à¹‰à¸‡à¸—à¸µà¹ˆà¹€à¸„à¹‰à¸²à¸­à¸¢à¸²à¸à¹ƒà¸«à¹‰à¹€à¸šà¹Šà¸šà¸”à¸¹à¹à¸¥à¸•à¸±à¸§à¹€à¸­à¸‡ 
à¸¡à¸±à¸™à¸„à¸·à¸­à¸à¸²à¸£à¸šà¸­à¸à¸£à¸±à¸à¸‚à¸­à¸‡à¹€à¸„à¹‰à¸²à¸«à¸¡à¸”à¹€à¸¥à¸¢à¸™à¸°

à¸‚à¸­à¸šà¸„à¸¸à¸“à¸—à¸µà¹ˆà¹€à¸‚à¹‰à¸²à¸¡à¸²à¹ƒà¸™à¸Šà¸µà¸§à¸´à¸•à¹€à¸„à¹‰à¸²à¸™à¸° à¸‚à¸­à¸šà¸„à¸¸à¸“à¸—à¸µà¹ˆà¸—à¸³à¹ƒà¸«à¹‰à¹€à¸„à¹‰à¸²à¹„à¸”à¹‰à¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸„à¸§à¸²à¸¡à¸£à¸±à¸à¸¡à¸±à¸™à¸ªà¸§à¸¢à¸‡à¸²à¸¡à¹à¸„à¹ˆà¹„à¸«à¸™ 
à¸‚à¸­à¸šà¸„à¸¸à¸“à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¸‚à¹‰à¸²à¸‡à¹† à¸à¸±à¸™à¹ƒà¸™à¸—à¸¸à¸à¸§à¸±à¸™ à¹à¸¥à¸°à¸‚à¸­à¸šà¸„à¸¸à¸“à¸—à¸µà¹ˆà¹€à¸›à¹‡à¸™à¹€à¸šà¹Šà¸šâ€¦ à¸„à¸™à¸—à¸µà¹ˆà¹€à¸„à¹‰à¸²à¸£à¸±à¸à¸—à¸µà¹ˆà¸ªà¸¸à¸”

à¸‚à¸­à¸šà¸„à¸¸à¸“à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¹€à¸„à¸µà¸¢à¸‡à¸‚à¹‰à¸²à¸‡à¸à¸±à¸™à¹€à¸ªà¸¡à¸­ à¹„à¸¡à¹ˆà¸§à¹ˆà¸²à¹€à¸§à¸¥à¸²à¸ˆà¸°à¸œà¹ˆà¸²à¸™à¹„à¸›à¸™à¸²à¸™à¹à¸„à¹ˆà¹„à¸«à¸™
à¹€à¸„à¹‰à¸²à¸à¹‡à¸ˆà¸°à¸£à¸±à¸à¹€à¸šà¹Šà¸šà¹€à¸ªà¸¡à¸­ à¹à¸¥à¸°à¸ˆà¸°à¸”à¸¹à¹à¸¥à¸«à¸±à¸§à¹ƒà¸ˆà¸‚à¸­à¸‡à¹€à¸£à¸²à¹ƒà¸«à¹‰à¸­à¸šà¸­à¸¸à¹ˆà¸™à¸•à¸¥à¸­à¸”à¹„à¸›

à¸£à¸±à¸à¹€à¸šà¹Šà¸šà¹€à¸ªà¸¡à¸­ â¤ï¸
`;

const LoveLetter = ({ open, onClose }) => {
  const [displayText, setDisplayText] = useState("");
  const [index, setIndex] = useState(0);

  useEffect(() => {
    if (open) {
      setDisplayText(""); // âœ… à¸£à¸µà¹€à¸‹à¹‡à¸•à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸à¹ˆà¸­à¸™à¹€à¸£à¸´à¹ˆà¸¡
      setIndex(0);
      console.log("à¹€à¸›à¸´à¸”à¸ˆà¸”à¸«à¸¡à¸²à¸¢: à¹€à¸£à¸´à¹ˆà¸¡à¸à¸´à¸¡à¸à¹Œà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡");

      const interval = setInterval(() => {
        setDisplayText((prev) => {
          console.log(`à¹€à¸à¸´à¹ˆà¸¡à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£: ${loveMessage[prev.length] || "à¸«à¸¡à¸”à¹à¸¥à¹‰à¸§"}`);
          return prev.length < loveMessage.length ? prev + loveMessage[prev.length] : prev;
        });

        setIndex((prev) => prev + 1);

        if (index >= loveMessage.length) {
          clearInterval(interval);
        }
      }, 50);

      return () => clearInterval(interval);
    }
  }, [open]);

  return (
    <Dialog open={open} onClose={onClose} maxWidth="sm">
      <Box
        sx={{
          p: 4,
          textAlign: "left",
          bgcolor: "#fff5f8",
          borderRadius: "12px",
          width: "400px",
          maxWidth: "90vw",
          position: "relative",
          boxShadow: "0 6px 15px rgba(255, 133, 162, 0.4)",
        }}
      >
        <IconButton
          onClick={onClose}
          sx={{
            position: "absolute",
            top: 10,
            right: 10,
            color: "#d63384",
            fontSize: "32px",
            cursor: "pointer",
          }}
        >
          <CloseIcon fontSize="large" />
        </IconButton>

        <Typography
          variant="h5"
          sx={{ color: "#d63384", fontWeight: "bold", mb: 2, textAlign: "center" }}
        >
          ğŸ’Œ à¸ˆà¸”à¸«à¸¡à¸²à¸¢à¸ˆà¸²à¸à¸™à¹‰à¸­à¸‡à¸«à¸¢à¸­à¸‡ ğŸ’Œ
        </Typography>

        <Typography
          variant="body1"
          sx={{
            color: "#333",
            fontSize: "18px",
            lineHeight: "1.6",
            fontFamily: "serif",
            whiteSpace: "pre-line",
            minHeight: "200px", // âœ… à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸à¸£à¸°à¸à¸£à¸´à¸šà¸‚à¸“à¸°à¹‚à¸«à¸¥à¸”
          }}
        >
          {displayText}
        </Typography>
      </Box>
    </Dialog>
  );
};

export default LoveLetter;
